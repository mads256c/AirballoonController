package com.aatg.elev.bluetoothdebugger.dataconverters;

import com.aatg.elev.bluetoothdebugger.IDataConverter;

import java.util.Dictionary;

public class TemperatureConverter implements IDataConverter {

    public static final double[] P100_TABLE = {
            18.49,
            18.93,
            19.36,
            19.79,
            20.22,
            20.65,
            21.08,
            21.51,
            21.94,
            22.37,
            22.8,
            23.23,
            23.66,
            24.09,
            24.52,
            24.94,
            25.37,
            25.8,
            26.23,
            26.65,
            27.08,
            27.5,
            27.93,
            28.35,
            28.78,
            29.2,
            29.63,
            30.05,
            30.47,
            30.9,
            31.32,
            31.74,
            32.16,
            32.59,
            33.01,
            33.43,
            33.85,
            34.27,
            34.69,
            35.11,
            35.53,
            35.95,
            36.37,
            36.79,
            37.21,
            37.63,
            38.04,
            38.46,
            38.88,
            39.3,
            39.71,
            40.13,
            40.55,
            40.96,
            41.38,
            41.79,
            42.21,
            42.63,
            43.04,
            43.45,
            43.87,
            44.28,
            44.7,
            45.11,
            45.52,
            45.94,
            46.35,
            46.76,
            47.18,
            47.59,
            48,
            48.41,
            48.82,
            49.23,
            49.64,
            50.06,
            50.47,
            50.88,
            51.29,
            51.7,
            52.11,
            52.52,
            52.92,
            53.33,
            53.74,
            54.15,
            54.56,
            54.97,
            55.38,
            55.78,
            56.19,
            56.6,
            57,
            57.41,
            57.82,
            58.22,
            58.63,
            59.04,
            59.44,
            59.85,
            60.25,
            60.66,
            61.06,
            61.47,
            61.87,
            62.28,
            62.68,
            63.09,
            63.49,
            63.9,
            64.3,
            64.7,
            65.11,
            65.51,
            65.91,
            66.31,
            66.72,
            67.12,
            67.52,
            67.92,
            68.33,
            68.73,
            69.13,
            69.53,
            69.93,
            70.33,
            70.73,
            71.13,
            71.53,
            71.93,
            72.33,
            72.73,
            73.13,
            73.53,
            73.93,
            74.33,
            74.73,
            75.13,
            75.53,
            75.93,
            76.33,
            76.73,
            77.13,
            77.52,
            77.92,
            78.32,
            78.72,
            79.11,
            79.51,
            79.91,
            80.31,
            80.7,
            81.1,
            81.5,
            81.89,
            82.29,
            82.69,
            83.08,
            83.48,
            83.88,
            84.27,
            84.67,
            85.06,
            85.46,
            85.85,
            86.25,
            86.64,
            87.04,
            87.43,
            87.83,
            88.22,
            88.62,
            89.01,
            89.4,
            89.8,
            90.19,
            90.59,
            90.98,
            91.37,
            91.77,
            92.16,
            92.55,
            92.95,
            93.34,
            93.73,
            94.12,
            94.52,
            94.91,
            95.3,
            95.69,
            96.09,
            96.48,
            96.87,
            97.26,
            97.65,
            98.04,
            98.44,
            98.83,
            99.22,
            99.61,
            100,
            100.39,
            100.78,
            101.17,
            101.56,
            101.95,
            102.34,
            102.73,
            103.12,
            103.51,
            103.9,
            104.29,
            104.68,
            105.07,
            105.46,
            105.85,
            106.24,
            106.63,
            107.02,
            107.4,
            107.79,
            108.18,
            108.57,
            108.96,
            109.35,
            109.73,
            110.12,
            110.51,
            110.9,
            111.28,
            111.67,
            112.06,
            112.45,
            112.83,
            113.22,
            113.61,
            113.99,
            114.38,
            114.77,
            115.15,
            115.54,
            115.93,
            116.31,
            116.7,
            117.08,
            117.47,
            117.85,
            118.24,
            118.62,
            119.01,
            119.4,
            119.78,
            120.16,
            120.55,
            120.93,
            121.32,
            121.7,
            122.09,
            122.47,
            122.86,
            123.24,
            123.62,
            124.01,
            124.39,
            124.77,
            125.16,
            125.54,
            125.92,
            126.31,
            126.69,
            127.07,
            127.45,
            127.84,
            128.22,
            128.6,
            128.98,
            129.37,
            129.75,
            130.13,
            130.51,
            130.89,
            131.27,
            131.66,
            132.04,
            132.42,
            132.8,
            133.18,
            133.56,
            133.94,
            134.32,
            134.7,
            135.08,
            135.46,
            135.84,
            136.22,
            136.6,
            136.98,
            137.36,
            137.74,
            138.12,
            138.5,
            138.88,
            139.26,
            139.64,
            140.02,
            140.39,
            140.77,
            141.15,
            141.53,
            141.91,
            142.29,
            142.66,
            143.04,
            143.42,
            143.8,
            144.17,
            144.55,
            144.93,
            145.31,
            145.68,
            146.06,
            146.44,
            146.81,
            147.19,
            147.57,
            147.94,
            148.32,
            148.7,
            149.07,
            149.45,
            149.82,
            150.2,
            150.57,
            150.95,
            151.33,
            151.7,
            152.08,
            152.45,
            152.83,
            153.2,
            153.58,
            153.95,
            154.32,
            154.7,
            155.07,
            155.45,
            155.82,
            156.19,
            156.57,
            156.94,
            157.31,
            157.69,
            158.06,
            158.43,
            158.81,
            159.18,
            159.55,
            159.93,
            160.3,
            160.67,
            161.04,
            161.42,
            161.79,
            162.16,
            162.53,
            162.9,
            163.27,
            163.65,
            164.02,
            164.39,
            164.76,
            165.13,
            165.5,
            165.87,
            166.24,
            166.61,
            166.98,
            167.35,
            167.72,
            168.09,
            168.46,
            168.83,
            169.2,
            169.57,
            169.94,
            170.31,
            170.68,
            171.05,
            171.42,
            171.79,
            172.16,
            172.53,
            172.9,
            173.26,
            173.63,
            174,
            174.37,
            174.74,
            175.1,
            175.47,
            175.84,
            176.21,
            176.57,
            176.94,
            177.31,
            177.68,
            178.04,
            178.41,
            178.78,
            179.14,
            179.51,
            179.88,
            180.24,
            180.61,
            180.97,
            181.34,
            181.71,
            182.07,
            182.44,
            182.8,
            183.17,
            183.53,
            183.9,
            184.26,
            184.63,
            184.99,
            185.36,
            185.72,
            186.09,
            186.45,
            186.82,
            187.18,
            187.54,
            187.91,
            188.27,
            188.63,
            189,
            189.36,
            189.72,
            190.09,
    };

    public static final int P100_START = -200;

    private int resistance;
    private double[] table;
    private int tableStart;

    public TemperatureConverter(int resistance, double[] table, int tableStart)
    {
        this.resistance = resistance;
        this.table = table;
        this.tableStart = tableStart;
    }

    @Override
    public Number getData(long data) {

        double Vout = data * (5.0 / 1023.0);
        double R2 = resistance * 1/(5.0/Vout - 1);

        int i = 0;

        for (double v:
             table) {

            if (v > R2) return i + tableStart;

            i++;
        }

        return table[(int)R2];
    }
}
